webpackJsonp([1],{Dm37:function(e,n){},JEnG:function(e,n){},NHnr:function(e,n,t){"use strict";function i(e){t("JEnG")}function o(e){t("Dm37")}function r(e){t("n4f/")}Object.defineProperty(n,"__esModule",{value:!0});var a=t("/5sW"),l={name:"app"},s=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{attrs:{id:"app"}},[t("router-view",{staticClass:"page"})],1)},c=[],d={render:s,staticRenderFns:c},f=d,u=t("VU/8"),p=i,h=u(l,f,!1,p,null,null),v=h.exports,m=t("/ocq"),y=t("//Fk"),_=t.n(y),b=function(){return(Math.round(100*performance.now())/100).toString()},g=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:14;return function(t,i){var o=b().padEnd(n)+" | ";if("string"==typeof t){var r=o+t;void 0===i?e(r):e(r,i)}else e(o,i)}},w=g(console.log.bind(console)),k=g(console.error.bind(console),12);w.error=k;var F=w,C=t("i58a"),I=t.n(C),D=t("zsG3"),L=t.n(D),E=function(){var e=[],n={},t=function(e,t){n[e]||(n[e]=[]),n[e].push(t)},i=function(e,t,i){n[e]&&n[e].forEach(function(e){return e(t,i)})},o=function(n){F("new peer connected: "+n.id),e.push(n),n.on("data",function(e){return i("data",n,e)}),n.on("close",function(){F("connection "+n.id+" leave us"),e=e.filter(function(e){return e!==n})})};return new _.a(function(n,i){var r=new L.a({key:I.a.peerjs.key,secure:!0});r.on("open",function(i){F("peer initialized with id: "+i),n({id:i,peer:r,on:t,connections:e})}),r.on("connection",o),r.on("error",function(e){F.error("peer problem",e),i(e)})})},z=function(e){var n=document.createElement("textarea");n.style.position="fixed",n.style.top=0,n.style.left=0,n.style.width="2em",n.style.height="2em",n.style.padding=0,n.style.border="none",n.style.outline="none",n.style.boxShadow="none",n.style.background="transparent",n.value=e,document.body.appendChild(n),n.select();var t=!1;try{document.execCommand("copy"),t=!0}catch(n){F.error("copying has failed ("+e+")")}return document.body.removeChild(n),t},x=z,S=t("jmmJ"),R=t.n(S),j=function(){return R()({length:32})},U=function(e,n){return(location.hash?location.href.slice(0,0-location.hash.length):location.href)+"#/file/"+e+"/"+n},q={name:"SharePage",data:function(){return{peer:null,failed:!1,loading:!0,copiedLink:null,files:window.files||(window.files=[])}},methods:{onDrop:function(e){for(var n=e.dataTransfer.files,t=n.length;t--;)this.addFile(n[t])},onSelectFile:function(e){for(var n=e.target.files,t=n.length;t--;)this.addFile(n[t])},addFile:function(e){var n={id:j(),name:e.name,size:e.size,type:e.type,file:e};this.files.push(n),this.peer&&this.shareFile(n)},shareFile:function(e){e.link=U(this.peer.id,e.id),F("link for "+e.name+": "+e.link)},sendFile:function(e,n){var t=n.name,i=n.type,o=new Blob([n.file],{type:i});e.send({method:"sendFile",file:{blob:o,name:t,type:i}})},copyLink:function(e,n){n.link?(F("copying link for "+n.name+": "+n.link),x(n.link)&&(e.preventDefault(),this.copiedLink=n.link)):F.error("link is not ready for "+n.name)},receiveData:function(e,n){switch(n.method){case"requestFile":F("requested "+n.fileId+" file");var t=this.files.find(function(e){return e.id===n.fileId});t?(F("sending file "+t.id+" ("+t.name+")"),this.sendFile(e,t)):(F.error("not exists file is requested "+n.fileId),e.send({method:"error",error:"no matching file found",fileId:n.fileId}));break;default:F.error("unknown event "+n.method+" is received",n)}}},filters:{size:function(e){return Math.round(e/1024/1024*100)/100+"Mb"}},mounted:function(){var e=this;F("creating new peer"),E().then(function(n){e.loading=!1,e.peer=n,e.peer.on("data",e.receiveData.bind(e)),e.files.forEach(function(n){return e.shareFile(n)})},function(n){e.failed=!0,F.error(n)})}},$=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"share-page",class:{failed:e.failed,loading:e.loading},on:{drop:function(n){return n.preventDefault(),e.onDrop(n)},dragover:function(e){e.preventDefault()}}},[t("div",{staticClass:"content"},[e.files.length?e._e():t("div",{staticClass:"placeholder"},[e._m(0),e._v(" "),t("p",{staticClass:"call-to-action"},[e._v("\n        drop files here,"),t("br"),e._v("or\n        "),t("label",{staticClass:"select-files"},[e._v("\n          choose them\n          "),t("input",{attrs:{type:"file",name:"files",multiple:""},on:{change:e.onSelectFile}})])])]),e._v(" "),e.files.length?t("div",{staticClass:"list"},[t("ul",e._l(e.files,function(n){return t("li",[t("a",{class:["file",{copied:n.link===e.copiedLink}],attrs:{href:n.link,target:"_blank"},on:{click:function(t){e.copyLink(t,n)},keydown:[function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.copyLink(t,n)},function(t){if(!("button"in t)&&e._k(t.keyCode,"space",32,t.key," "))return null;e.copyLink(t,n)}]}},[e._v("\n            "+e._s(n.name)+"\n            ("+e._s(e._f("size")(n.size))+")\n          ")])])})),e._v(" "),t("p",{staticClass:"tip"},[e._v("\n        click the file name to copy the link or\n        "),t("label",{staticClass:"select-files"},[e._v("\n          add more\n          "),t("input",{attrs:{type:"file",name:"files",multiple:""},on:{change:e.onSelectFile}})])])]):e._e()])])},H=[function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("p",[e._v("Here you can share files with anybody by peer-to-peer connection using modern WebRTC technology. It means that you won't download your files to any server, people who you share files with will download them directly from your browser (it is more "),t("strong",[e._v("fast")]),e._v(" and "),t("strong",[e._v("secure")]),e._v(" way to share files).")])}],P={render:$,staticRenderFns:H},B=P,G=t("VU/8"),J=o,M=G(q,B,!1,J,"data-v-1d361ad9",null),O=M.exports,N=function(e,n){var t=document.createElement("a");t.style="display: none",t.href=e,t.download=n,document.body.appendChild(t),t.click(),console.log(t),t.remove()},T=N,V=function(e){var n={},t=function(e,t){n[e]||(n[e]=[]),n[e].push(t)},i=function(e,t){n[e]&&n[e].forEach(function(e){return e(t)})};return new _.a(function(n,o){var r=new L.a({key:I.a.peerjs.key,secure:!0});r.on("open",function(a){F("peer initialized with id: "+a);var l=r.connect(e);l.on("data",function(e){return i("data",e)}),l.on("open",function(){F("connected to remote peer "+e),n({id:a,peer:r,connection:l,on:t})}),l.on("error",function(e){F.error("connection problem",e),o(e)})}),r.on("error",function(e){F.error("peer problem",e),o(e)})})},W={name:"FilePage",data:function(){return{peer:null,loading:!0,failed:!1,error:null}},computed:{peerId:function(){return this.$route.params.peer},fileId:function(){return this.$route.params.file}},methods:{downloadFile:function(){F("request file "+this.fileId),this.send({method:"requestFile",fileId:this.fileId})},send:function(e){this.peer.connection.send(e)},receiveData:function(e){switch(e.method){case"sendFile":F("remote server send a file "+e.file.name,e);var n=new Blob([e.file.blob],{type:e.file.type}),t=URL.createObjectURL(n);T(t,e.file.name),URL.revokeObjectURL(t);break;case"error":F.error("remote server send an error",e);break;default:F.error("unknown event "+e.method+" is received",e)}}},mounted:function(){var e=this;V(this.peerId).then(function(n){e.peer=n,e.peer.on("data",e.receiveData.bind(e))}).then(function(){e.loading=!1})}},A=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"file-page",class:{failed:e.failed,loading:e.loading}},[t("div",{staticClass:"content"},[e.loading?t("p",[e._v("loading...")]):e._e(),e._v(" "),e.loading?e._e():t("div",[e.failed?e._e():t("input",{attrs:{type:"button",value:"download file"},on:{click:e.downloadFile}}),e._v(" "),e.failed?e._e():t("p",{staticClass:"tip"},[e._v("you are here because somebody wants to share file with you")]),e._v(" "),e.failed?e._e():t("p",{staticClass:"tip"},[e._v("if you want, you can "),t("router-link",{attrs:{to:"/"}},[e._v("share files")]),e._v(" too")],1),e._v(" "),e.failed?t("p",[e._v(e._s(e.error))]):e._e()])])])},K=[],Q={render:A,staticRenderFns:K},X=Q,Y=t("VU/8"),Z=r,ee=Y(W,X,!1,Z,"data-v-30961eab",null),ne=ee.exports;a.a.use(m.a);var te=new m.a({routes:[{path:"/",name:"SharePage",component:O},{path:"/file/:peer/:file",name:"DownloadPage",component:ne}]});a.a.config.productionTip=!1,F("start new application"),new a.a({el:"#app",router:te,render:function(e){return e(v)}})},i58a:function(e,n){e.exports={firebase:{apiKey:"AIzaSyBHsb4fmCGupwqcdz5bdDnOpSNLpHwWvLw",authDomain:"webrtc-sfs.firebaseapp.com",databaseURL:"https://webrtc-sfs.firebaseio.com",projectId:"webrtc-sfs",storageBucket:"",messagingSenderId:"685746255008"},peerjs:{key:"zcn86e7y7xkr19k9"}}},"n4f/":function(e,n){}},["NHnr"]);
//# sourceMappingURL=app.5f4630b4909c8e8a85e5.js.map